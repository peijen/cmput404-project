
{% extends 'base.html' %}

{% block content %}

 <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
 <script src="/static/js/js.cookie.js"></script>
 <link rel="stylesheet" href="/static/css/friendrequest.css"/>
<div class="container">




<div class="row">
</div>
</div>
<div class="entry">
</div>
<div class = "jumbotron" id="jumbobody">
<h1>Friend Requests</h1>




{% for i in pendingFriend %}
<span id="disName">
  {{i.username}} </span> <span id="Btn"> <button id="{{i.request_id}}" type="submit"
						 data="accept">Accept</button> <button id="{{i.request_id}}" type="submit"
						 data="decline">Decline</button> </span> </br></br>

{% endfor %}

</div>
<script type="text/javascript">

$("button").click(function(e){
    //debugger;
    
    console.log("I GOT HERE");
    console.log(this.id);
    console.log(this.getAttribute("data"));
    e.preventDefault();
    var csrftoken = Cookies.get('csrftoken');
    //sending data using post


    var data= {
               "id": this.id,
               "action": this.getAttribute("data") 
              }   


    function csrfSafeMethod(method) {
      // these HTTP methods do not require CSRF protection
      return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }

    $.ajaxSetup({
      beforeSend: function(xhr, settings) {
          if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
              xhr.setRequestHeader("X-CSRFToken", csrftoken);
          }
      }
    });
 
    $.ajax({
        cache: false,
        url : "/service/friendrequest_ad",
        type: "POST",
        contentType:"application/json; charset=utf-8",
        data: JSON.stringify(data),
        dataType : "json",
        //data : data,
        success : function(callback){
            //Where $(this) => context == FORM

            //$(this).html("Received HTTP 200. Post should now be in database.");
            //window.location.href = "{% url 'website:home'%}"
            console.log("SUCCESSSSSSS");
            location.reload();

        },
        error : function(xhr, thrownError){
            console.log(xhr.status);
            console.log(thrownError)
            $(this).html("Error!");
        }
    });
 
    //root user id: 6a431053-35bc-4c44-8250-06c65f577864
   

});

</script>




{% endblock %}
